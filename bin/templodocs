#!/usr/bin/env php
<?php

use Ziumper\Templodocs\Core\CsvReaderBuilder;
use Ziumper\Templodocs\Tempo\TempoReporter;
use Ziumper\Templodocs\WordFileGenerator;

require __DIR__ . '/../vendor/autoload.php';


// Grab CLI arguments
$csv = $argv[1] ?? 'templates/data.csv';           // Default if not passed
$template = $argv[2] ?? 'templates/template.docx'; // Default if not passed
$reportFile = $argv[3] ?? 'report';                // Default if not passed


$tempoReader = new TempoReporter();
$reader = (new CsvReaderBuilder())->withPath($csv)->build();
$generator = new WordFileGenerator($template,$reportFile, $tempoReader->getContent($reader));
$generator->generate();

