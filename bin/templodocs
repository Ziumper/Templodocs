#!/usr/bin/env php
<?php

use Ziumper\Templodocs\Core\CsvReaderBuilder;
use Ziumper\Templodocs\Tempo\TempoReport;
use Ziumper\Templodocs\WordFileGenerator;

require __DIR__ . '/../vendor/autoload.php';


// Grab CLI arguments
$csv = $argv[1] ?? 'templates/data.csv';           // Default if not passed
$template = $argv[2] ?? 'templates/template.docx'; // Default if not passed
$reportFile = $argv[3] ?? 'report';                // Default if not passed
$translationFrom = $argv[4] ?? null;
$translationTo = $argv[5] ?? null;
$jiraLink = $argv[6] ?? null;

$reader = (new CsvReaderBuilder())->withPath($csv)->build();
$report = new TempoReport($reader);

$generator = new WordFileGenerator($template,$reportFile, $report->getContent());
$generator->generate();

